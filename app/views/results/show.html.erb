<div class="results-container">
  <h1 class="title-results">VOS RESULTATS</h1>
  <p class="results-description">Voici une sélection de parfums qui correspondent parfaitement à vos goûts et préférences olfactives. Selon vos réponses, vous découvrirez des fragrances avec des notes de tête fraîches et fruitées, des notes de cœur florales et élégantes, ainsi que des notes de fond chaleureuses et boisées. Explorez ces créations uniques qui reflètent votre personnalité !</p>

  <p class="results-amount">NOMBRE DE RÉSULTATS : <%= @perfumes_count %></p>

  <ul class="perfume-list">
    <% @perfumes.each do |perfume| %>
      <li class="perfume-item">
        <div class="card h-100">
          <%= link_to perfume_path(perfume), class: "text-decoration-none text-dark" do %>
            <div class="position-relative">
              <% if perfume.illustration.attached? %>
                <%= cl_image_tag perfume.illustration.key, alt: perfume.name, class: "img-fluid" %>
              <% else %>
                <img src="<%= perfume.photo %>" class="card-img-top" alt="<%= perfume.name %>">
              <% end %>
              <% if current_user.favorites.exists?(perfume: perfume) %>
                <%= link_to perfume_favorite_path(perfume, current_user.favorites.find_by(perfume: perfume)), method: :delete, class: "position-absolute top-0 end-0 btn btn-link" do %>
                  <i class="fa-solid fa-heart fa-2x"></i>
                <% end %>
              <% else %>
                <%= link_to perfume_favorites_path(perfume_id: perfume.id), method: :post, class: "position-absolute top-0 end-0 btn btn-link" do %>
                  <i class="fa-regular fa-heart fa-2x"></i>
                <% end %>
              <% end %>
            </div>
            <div class="card-body">
              <h5 class="card-title"><%= perfume.name %></h5>
              <p class="card-text"><strong><%= perfume.brand %></strong></p>
              <p class="card-text-price"><%= number_to_currency(perfume.price, unit: "€") %></p>
              <p class="card-text">Avis (<%= perfume.reviews.count %>)</p>
              <div class="rating">
                <% average_rating = perfume.reviews.average(:rating).to_f.round(1) %>
                <% average_rating.to_i.times do %>
                  <i class="bi bi-star-fill"></i>
                <% end %>
                <% (5 - average_rating.to_i).times do %>
                  <i class="bi bi-star"></i>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </li>
    <% end %>
  </ul>
</div>
